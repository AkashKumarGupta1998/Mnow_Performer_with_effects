<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warehouse Performance Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .ranking-table {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            max-height: 600px;
            overflow-y: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 12px 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        tr:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .rank-cell {
            font-weight: bold;
            text-align: center;
            width: 60px;
        }
        
        .warehouse-name {
            font-weight: 600;
        }
        
        .metrics-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .metric-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .metric {
            margin-bottom: 25px;
        }
        
        .metric-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .metric-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .metric-value {
            height: 100%;
            border-radius: 4px;
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 30px;
        }
        
        button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            backdrop-filter: blur(5px);
        }
        
        button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .podium {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            height: 200px;
            margin-bottom: 30px;
            gap: 10px;
        }
        
        .podium-item {
            text-align: center;
            color: white;
            border-radius: 10px 10px 0 0;
            padding: 10px;
            width: 100px;
            position: relative;
            transition: all 0.5s;
        }
        
        .rank-1 {
            height: 160px;
            background: linear-gradient(to bottom, #ffd700, #ffa500);
            order: 2;
        }
        
        .rank-2 {
            height: 120px;
            background: linear-gradient(to bottom, #c0c0c0, #a0a0a0);
            order: 1;
        }
        
        .rank-3 {
            height: 100px;
            background: linear-gradient(to bottom, #cd7f32, #a56a2b);
            order: 3;
        }
        
        .podium-rank {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .podium-name {
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .highlight {
            animation: pulse 2s infinite;
            border-left: 4px solid #ffd700;
        }
        
        @keyframes pulse {
            0% { background-color: rgba(255, 215, 0, 0.1); }
            50% { background-color: rgba(255, 215, 0, 0.3); }
            100% { background-color: rgba(255, 215, 0, 0.1); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes countdown {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(0); opacity: 0; }
        }
        
        @keyframes fastShuffle {
            0% { transform: translateY(0); }
            25% { transform: translateY(-15px); }
            50% { transform: translateY(15px); }
            75% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }
        
        @keyframes slowShuffle {
            0% { transform: translateY(0); }
            25% { transform: translateY(-8px); }
            50% { transform: translateY(8px); }
            75% { transform: translateY(-4px); }
            100% { transform: translateY(0); }
        }
        
        @keyframes finalReveal {
            0% { transform: scale(0.8) translateY(20px); opacity: 0; }
            100% { transform: scale(1) translateY(0); opacity: 1; }
        }
        
        .slide-in {
            animation: slideIn 0.8s ease-out;
        }
        
        .positive-metric {
            color: #4CAF50;
        }
        
        .negative-metric {
            color: #F44336;
        }
        
        .data-entry-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            margin-top: 30px;
        }
        
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .data-entry-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .data-entry-controls button {
            flex: 1;
            min-width: 150px;
        }
        
        .data-entry-table-container {
            overflow-x: auto;
            margin-bottom: 20px;
        }
        
        .data-entry-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }
        
        .data-entry-table th {
            background: rgba(0, 0, 0, 0.4);
            padding: 12px 8px;
            text-align: center;
            position: relative;
        }
        
        .data-entry-table td {
            padding: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .data-entry-table input {
            width: 100%;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            color: white;
            text-align: center;
        }
        
        .data-entry-table input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .remove-col-btn, .remove-row-btn {
            background: rgba(244, 67, 54, 0.3);
            padding: 4px 8px;
            font-size: 0.8rem;
            margin-left: 5px;
        }
        
        .remove-col-btn:hover, .remove-row-btn:hover {
            background: rgba(244, 67, 54, 0.5);
        }
        
        .add-col-btn {
            background: rgba(76, 175, 80, 0.3);
            padding: 4px 8px;
            font-size: 0.8rem;
            margin-left: 5px;
        }
        
        .add-col-btn:hover {
            background: rgba(76, 175, 80, 0.5);
        }
        
        .column-controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }
        
        .column-controls input {
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            color: white;
            width: 200px;
        }
        
        .status-message {
            padding: 10px;
            border-radius: 5px;
            margin-top: 15px;
            text-align: center;
            font-weight: 600;
            display: none;
        }
        
        .status-success {
            background: rgba(76, 175, 80, 0.3);
            border: 1px solid rgba(76, 175, 80, 0.5);
            display: block;
        }
        
        .status-error {
            background: rgba(244, 67, 54, 0.3);
            border: 1px solid rgba(244, 67, 54, 0.5);
            display: block;
        }
        
        .countdown-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
            display: none;
        }
        
        .countdown-number {
            font-size: 10rem;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            animation: countdown 1s ease-out;
        }
        
        .countdown-text {
            font-size: 2rem;
            margin-top: 20px;
            color: white;
        }
        
        .fast-shuffle {
            animation: fastShuffle 0.3s ease-in-out infinite;
        }
        
        .slow-shuffle {
            animation: slowShuffle 0.6s ease-in-out infinite;
        }
        
        .final-position {
            animation: finalReveal 0.8s ease-out forwards;
        }
        
        /* Fireworks Styles */
        .fireworks-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
            display: none;
        }
        
        .firework {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            box-shadow: 0 0 10px 2px;
        }
        
        .explosion {
            position: absolute;
            border-radius: 50%;
            opacity: 0;
        }
        
        .cracker {
            position: absolute;
            width: 4px;
            height: 20px;
            background: #ff6b01;
            border-radius: 2px;
        }
        
        .spark {
            position: absolute;
            width: 2px;
            height: 10px;
            background: #ffeb3b;
            border-radius: 1px;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0;
        }
        
        @media (max-width: 1100px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .metrics-panel {
                order: -1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Warehouse Performance Dashboard</h1>
            <div class="subtitle">Dynamic Data Entry with Fireworks Celebration</div>
        </header>
        
        <div class="dashboard">
            <div class="ranking-table">
                <table>
                    <thead id="dashboard-header">
                        <tr>
                            <th>Rank</th>
                            <th>Warehouse Name</th>
                            <!-- Dynamic columns will be added here -->
                        </tr>
                    </thead>
                    <tbody id="ranking-body">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div class="metrics-panel">
                <h2 class="metric-title">Top Performers</h2>
                <div class="podium">
                    <div class="podium-item rank-1">
                        <div class="podium-rank">1</div>
                        <div class="podium-name" id="podium-1">-</div>
                    </div>
                    <div class="podium-item rank-2">
                        <div class="podium-rank">2</div>
                        <div class="podium-name" id="podium-2">-</div>
                    </div>
                    <div class="podium-item rank-3">
                        <div class="podium-rank">3</div>
                        <div class="podium-name" id="podium-3">-</div>
                    </div>
                </div>
                
                <h2 class="metric-title">Key Averages</h2>
                <div id="averages-container">
                    <!-- Dynamic averages will be added here -->
                </div>
                
                <div class="controls">
                    <button id="animate-rank">Animate Ranking</button>
                    <button id="toggle-view">Toggle Compact View</button>
                    <button id="reset-data">Reset to Original Data</button>
                </div>
            </div>
        </div>
        
        <div class="data-entry-section">
            <h2 class="section-title">Dynamic Data Entry</h2>
            
            <div class="data-entry-controls">
                <button id="add-new-row">Add New Row</button>
                <button id="add-new-col">Add New Column</button>
                <button id="update-dashboard">Update Dashboard</button>
                <button id="clear-all">Clear All Data</button>
            </div>
            
            <div class="column-controls">
                <input type="text" id="new-column-name" placeholder="New column name">
                <button id="add-custom-col">Add Custom Column</button>
            </div>
            
            <div class="data-entry-table-container">
                <table class="data-entry-table">
                    <thead id="data-entry-header">
                        <tr>
                            <th>Store Name <button class="remove-col-btn" data-col="name">×</button></th>
                            <th>Serviceability% <button class="remove-col-btn" data-col="serviceability">×</button></th>
                            <th>Units <button class="remove-col-btn" data-col="units">×</button></th>
                            <th>Delivered Units <button class="remove-col-btn" data-col="deliveredUnits">×</button></th>
                            <th>Orders <button class="remove-col-btn" data-col="orders">×</button></th>
                            <th>Delivered Orders <button class="remove-col-btn" data-col="deliveredOrders">×</button></th>
                            <th>SLA <button class="remove-col-btn" data-col="sla">×</button></th>
                            <th>O2D <button class="remove-col-btn" data-col="o2d">×</button></th>
                            <th>Breadx% <button class="remove-col-btn" data-col="breadx">×</button></th>
                            <th>Deep Pain% <button class="remove-col-btn" data-col="deepPain">×</button></th>
                            <th>Cancellation% <button class="remove-col-btn" data-col="cancellation">×</button></th>
                            <th>RTO% <button class="remove-col-btn" data-col="rto">×</button></th>
                            <th>Rank <button class="remove-col-btn" data-col="rank">×</button></th>
                            <th>Actions <button class="add-col-btn">+</button></th>
                        </tr>
                    </thead>
                    <tbody id="data-entry-body">
                        <tr>
                            <td><input type="text" placeholder="Warehouse Name" class="entry-name"></td>
                            <td><input type="text" placeholder="100.00%" class="entry-serviceability"></td>
                            <td><input type="number" placeholder="0" class="entry-units"></td>
                            <td><input type="number" placeholder="0" class="entry-delivered-units"></td>
                            <td><input type="number" placeholder="0" class="entry-orders"></td>
                            <td><input type="number" placeholder="0" class="entry-delivered-orders"></td>
                            <td><input type="number" step="0.01" placeholder="0.00" class="entry-sla"></td>
                            <td><input type="number" step="0.01" placeholder="0.00" class="entry-o2d"></td>
                            <td><input type="text" placeholder="0.00%" class="entry-breadx"></td>
                            <td><input type="text" placeholder="0.00%" class="entry-deep-pain"></td>
                            <td><input type="text" placeholder="0.00%" class="entry-cancellation"></td>
                            <td><input type="text" placeholder="0.00%" class="entry-rto"></td>
                            <td><input type="number" placeholder="0" class="entry-rank"></td>
                            <td><button class="remove-row-btn">Remove</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div id="status-message" class="status-message"></div>
        </div>
        
        <!-- Countdown Overlay -->
        <div class="countdown-overlay" id="countdown-overlay">
            <div class="countdown-number" id="countdown-number">5</div>
            <div class="countdown-text">Calculating Rankings...</div>
        </div>
        
        <!-- Fireworks Container -->
        <div class="fireworks-container" id="fireworks-container"></div>
    </div>
     <!-- 2nd part -->
      <script>
        // Original data as provided
        let warehouseData = [
            {
                name: "Mandawali Mnow SF",
                serviceability: "100.00%",
                units: 1218,
                deliveredUnits: 1048,
                orders: 778,
                deliveredOrders: 663,
                sla: 48.42,
                o2d: 21.23,
                breadx: "0.26%",
                deepPain: "0.00%",
                cancellation: "9.00%",
                rto: "0.51%",
                rank: 1
            },
            {
                name: "PushpVihar Mnow SF",
                serviceability: "100.00%",
                units: 970,
                deliveredUnits: 793,
                orders: 615,
                deliveredOrders: 493,
                sla: 57.55,
                o2d: 27.55,
                breadx: "0.33%",
                deepPain: "0.00%",
                cancellation: "12.03%",
                rto: "0.98%",
                rank: 2
            },
            {
                name: "Janakpuri Mnow SF",
                serviceability: "100.00%",
                units: 949,
                deliveredUnits: 840,
                orders: 611,
                deliveredOrders: 547,
                sla: 47.68,
                o2d: 16.85,
                breadx: "0.49%",
                deepPain: "0.33%",
                cancellation: "3.60%",
                rto: "1.64%",
                rank: 3
            },
            {
                name: "Sultanpuri Mnow SF",
                serviceability: "100.00%",
                units: 831,
                deliveredUnits: 717,
                orders: 501,
                deliveredOrders: 416,
                sla: 51.92,
                o2d: 24.79,
                breadx: "1.20%",
                deepPain: "0.00%",
                cancellation: "10.18%",
                rto: "1.40%",
                rank: 4
            },
            {
                name: "KirtNagar Mnow SF",
                serviceability: "100.00%",
                units: 905,
                deliveredUnits: 771,
                orders: 564,
                deliveredOrders: 487,
                sla: 49,
                o2d: 19.03,
                breadx: "0.71%",
                deepPain: "0.00%",
                cancellation: "8.87%",
                rto: "1.60%",
                rank: 5
            }
        ];

        // Available metrics with their properties
        const metricProperties = {
            name: { type: 'text', display: 'Store Name', required: true },
            serviceability: { type: 'text', display: 'Serviceability%' },
            units: { type: 'number', display: 'Units' },
            deliveredUnits: { type: 'number', display: 'Delivered Units' },
            orders: { type: 'number', display: 'Orders' },
            deliveredOrders: { type: 'number', display: 'Delivered Orders' },
            sla: { type: 'number', display: 'SLA', step: '0.01' },
            o2d: { type: 'number', display: 'O2D', step: '0.01' },
            breadx: { type: 'text', display: 'Breadx%' },
            deepPain: { type: 'text', display: 'Deep Pain%' },
            cancellation: { type: 'text', display: 'Cancellation%' },
            rto: { type: 'text', display: 'RTO%' },
            rank: { type: 'number', display: 'Rank' }
        };

        // Current columns in the data entry table
        let currentColumns = Object.keys(metricProperties);

        // Function to format numbers with commas
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // Function to populate the dashboard table
        function populateDashboard() {
            const header = document.getElementById('dashboard-header');
            const body = document.getElementById('ranking-body');
            
            // Clear existing content
            header.innerHTML = '';
            body.innerHTML = '';
            
            // Create header row
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = '<th>Rank</th><th>Warehouse Name</th>';
            
            // Add metric columns to header
            currentColumns.forEach(col => {
                if (col !== 'name' && col !== 'rank') {
                    headerRow.innerHTML += `<th>${metricProperties[col].display}</th>`;
                }
            });
            
            header.appendChild(headerRow);
            
            // Sort data by rank
            const sortedData = [...warehouseData].sort((a, b) => (a.rank || 0) - (b.rank || 0));
            
            // Create data rows
            sortedData.forEach(warehouse => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="rank-cell">${warehouse.rank || '-'}</td>
                    <td class="warehouse-name">${warehouse.name}</td>
                `;
                
                // Add metric columns to row
                currentColumns.forEach(col => {
                    if (col !== 'name' && col !== 'rank') {
                        let value = warehouse[col] || '-';
                        if (typeof value === 'number' && col !== 'sla' && col !== 'o2d') {
                            value = formatNumber(value);
                        }
                        const cellClass = col.includes('cancellation') || col.includes('rto') || 
                                        col.includes('breadx') || col.includes('deepPain') ? 
                                        'negative-metric' : 'positive-metric';
                        row.innerHTML += `<td class="${cellClass}">${value}</td>`;
                    }
                });
                
                // Add highlight to top 3 performers
                if (warehouse.rank && warehouse.rank <= 3) {
                    row.classList.add('highlight');
                }
                
                body.appendChild(row);
            });
        }

        // Function to update podium
        function updatePodium() {
            // Sort by rank and get top 3
            const sortedData = [...warehouseData].sort((a, b) => (a.rank || 0) - (b.rank || 0));
            const top3 = sortedData.slice(0, 3);
            
            document.getElementById('podium-1').textContent = top3[0] ? top3[0].name.split(' ')[0] : '-';
            document.getElementById('podium-2').textContent = top3[1] ? top3[1].name.split(' ')[0] : '-';
            document.getElementById('podium-3').textContent = top3[2] ? top3[2].name.split(' ')[0] : '-';
        }

        // Function to update averages
        function updateAverages() {
            const container = document.getElementById('averages-container');
            container.innerHTML = '';
            
            // Calculate averages for numeric metrics
            currentColumns.forEach(col => {
                if (col !== 'name' && col !== 'rank' && metricProperties[col].type === 'number') {
                    const values = warehouseData
                        .map(item => parseFloat(item[col]))
                        .filter(val => !isNaN(val));
                    
                    if (values.length > 0) {
                        const avg = values.reduce((sum, val) => sum + val, 0) / values.length;
                        
                        const metricEl = document.createElement('div');
                        metricEl.className = 'metric';
                        metricEl.innerHTML = `
                            <div class="metric-label">
                                <span>Avg ${metricProperties[col].display}</span>
                                <span>${avg.toFixed(2)}</span>
                            </div>
                            <div class="metric-bar">
                                <div class="metric-value" style="width: ${Math.min(avg, 100)}%; 
                                    background: linear-gradient(to right, #4facfe, #00f2fe);"></div>
                            </div>
                        `;
                        container.appendChild(metricEl);
                    }
                }
            });
            
            // If no averages, show message
            if (container.innerHTML === '') {
                container.innerHTML = '<p style="text-align: center; opacity: 0.7;">No numeric data available for averages</p>';
            }
        }

        // Function to create fireworks animation
        function createFireworks() {
            const container = document.getElementById('fireworks-container');
            container.style.display = 'block';
            container.innerHTML = '';
            
            // Create multiple fireworks
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    createSingleFirework();
                }, i * 300);
            }
            
            // Hide fireworks after animation
            setTimeout(() => {
                container.style.display = 'none';
            }, 6000);
        }

        // Function to create a single firework
        function createSingleFirework() {
            const container = document.getElementById('fireworks-container');
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff6b01', '#ffeb3b'];
            
            // Random position
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight;
            
            // Create firework
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            firework.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            firework.style.boxShadow = `0 0 10px 2px ${firework.style.backgroundColor}`;
            container.appendChild(firework);
            
            // Animate firework rising
            let riseInterval = setInterval(() => {
                const currentTop = parseFloat(firework.style.top);
                if (currentTop > 100) {
                    firework.style.top = (currentTop - 2) + 'px';
                } else {
                    clearInterval(riseInterval);
                    explodeFirework(firework);
                }
            }, 20);
        }

        // Function to explode a firework
        function explodeFirework(firework) {
            const container = document.getElementById('fireworks-container');
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff6b01', '#ffeb3b'];
            const x = parseFloat(firework.style.left);
            const y = parseFloat(firework.style.top);
            
            // Remove the original firework
            container.removeChild(firework);
            
            // Create explosion particles
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'explosion';
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                particle.style.width = '4px';
                particle.style.height = '4px';
                container.appendChild(particle);
                
                // Animate particle
                const angle = Math.random() * Math.PI * 2;
                const speed = 2 + Math.random() * 3;
                const vx = Math.cos(angle) * speed;
                const vy = Math.sin(angle) * speed;
                
                let opacity = 1;
                let size = 4;
                let particleInterval = setInterval(() => {
                    const currentLeft = parseFloat(particle.style.left);
                    const currentTop = parseFloat(particle.style.top);
                    
                    particle.style.left = (currentLeft + vx) + 'px';
                    particle.style.top = (currentTop + vy) + 'px';
                    
                    // Fade out and grow
                    opacity -= 0.02;
                    size += 0.1;
                    particle.style.opacity = opacity;
                    particle.style.width = size + 'px';
                    particle.style.height = size + 'px';
                    
                    if (opacity <= 0) {
                        clearInterval(particleInterval);
                        if (particle.parentNode) {
                            container.removeChild(particle);
                        }
                    }
                }, 30);
            }
            
            // Create crackers
            createCrackers(x, y);
        }

        // Function to create crackers
        function createCrackers(x, y) {
            const container = document.getElementById('fireworks-container');
            
            for (let i = 0; i < 8; i++) {
                const cracker = document.createElement('div');
                cracker.className = 'cracker';
                cracker.style.left = x + 'px';
                cracker.style.top = y + 'px';
                cracker.style.transform = `rotate(${i * 45}deg)`;
                container.appendChild(cracker);
                
                // Animate cracker
                const angle = (i * 45) * Math.PI / 180;
                const distance = 50 + Math.random() * 50;
                const targetX = x + Math.cos(angle) * distance;
                const targetY = y + Math.sin(angle) * distance;
                
                let progress = 0;
                const crackerInterval = setInterval(() => {
                    progress += 0.05;
                    const currentX = x + (targetX - x) * progress;
                    const currentY = y + (targetY - y) * progress;
                    
                    cracker.style.left = currentX + 'px';
                    cracker.style.top = currentY + 'px';
                    
                    if (progress >= 1) {
                        clearInterval(crackerInterval);
                        explodeCracker(cracker);
                    }
                }, 20);
            }
        }

        // Function to explode a cracker
        function explodeCracker(cracker) {
            const container = document.getElementById('fireworks-container');
            const x = parseFloat(cracker.style.left);
            const y = parseFloat(cracker.style.top);
            
            // Remove the cracker
            container.removeChild(cracker);
            
            // Create sparks
            for (let i = 0; i < 12; i++) {
                const spark = document.createElement('div');
                spark.className = 'spark';
                spark.style.left = x + 'px';
                spark.style.top = y + 'px';
                container.appendChild(spark);
                
                // Animate spark
                const angle = Math.random() * Math.PI * 2;
                const distance = 20 + Math.random() * 30;
                const targetX = x + Math.cos(angle) * distance;
                const targetY = y + Math.sin(angle) * distance;
                
                let progress = 0;
                const sparkInterval = setInterval(() => {
                    progress += 0.1;
                    const currentX = x + (targetX - x) * progress;
                    const currentY = y + (targetY - y) * progress;
                    
                    spark.style.left = currentX + 'px';
                    spark.style.top = currentY + 'px';
                    spark.style.opacity = 1 - progress;
                    
                    if (progress >= 1) {
                        clearInterval(sparkInterval);
                        if (spark.parentNode) {
                            container.removeChild(spark);
                        }
                    }
                }, 30);
            }
        }

        // Function to animate ranking changes with 5-second countdown
        function animateRankingWithCountdown() {
            const countdownOverlay = document.getElementById('countdown-overlay');
            const countdownNumber = document.getElementById('countdown-number');
            
            // Show countdown overlay
            countdownOverlay.style.display = 'flex';
            
            // Disable buttons during animation
            document.querySelectorAll('button').forEach(btn => {
                btn.disabled = true;
            });
            
            // Countdown from 5 to 1
            let count = 5;
            countdownNumber.textContent = count;
            
            const countdownInterval = setInterval(() => {
                count--;
                if (count > 0) {
                    countdownNumber.textContent = count;
                    countdownNumber.style.animation = 'none';
                    setTimeout(() => {
                        countdownNumber.style.animation = 'countdown 1s ease-out';
                    }, 10);
                } else {
                    clearInterval(countdownInterval);
                    countdownNumber.textContent = 'GO!';
                    countdownNumber.style.animation = 'countdown 1s ease-out';
                    
                    // After countdown, start the ranking animation
                    setTimeout(() => {
                        countdownOverlay.style.display = 'none';
                        startMultiPhaseRankingAnimation();
                    }, 1000);
                }
            }, 1000);
        }

        // Function to start the multi-phase ranking animation
        function startMultiPhaseRankingAnimation() {
            const rows = document.querySelectorAll('#ranking-body tr');
            const podiumItems = document.querySelectorAll('.podium-item');
            
            // Reset all rows and podium
            rows.forEach(row => {
                row.style.transform = 'translateY(0)';
                row.style.opacity = '1';
                row.classList.remove('fast-shuffle', 'slow-shuffle', 'final-position');
            });
            
            podiumItems.forEach(item => {
                item.style.transform = 'scale(0)';
                item.style.opacity = '0';
            });
            
            // Phase 1: Fast shuffle (2 seconds)
            rows.forEach(row => {
                row.classList.add('fast-shuffle');
            });
            
            // After 2 seconds, transition to slow shuffle
            setTimeout(() => {
                rows.forEach(row => {
                    row.classList.remove('fast-shuffle');
                    row.classList.add('slow-shuffle');
                });
                
                // After 2 more seconds, transition to final positions with fireworks
                setTimeout(() => {
                    rows.forEach(row => {
                        row.classList.remove('slow-shuffle');
                        row.classList.add('final-position');
                    });
                    
                    // Start fireworks animation
                    createFireworks();
                    
                    // Animate podium items
                    podiumItems.forEach((item, index) => {
                        setTimeout(() => {
                            item.style.transition = 'transform 0.5s ease-out, opacity 0.5s ease-out';
                            item.style.transform = 'scale(1)';
                            item.style.opacity = '1';
                        }, index * 300);
                    });
                    
                    // Re-enable buttons after animation
                    setTimeout(() => {
                        document.querySelectorAll('button').forEach(btn => {
                            btn.disabled = false;
                        });
                    }, 3000);
                }, 2000);
            }, 2000);
        }

  <!-- part 3 -->         
              // Function to add a new row to the data entry table
        function addNewRow() {
            const tbody = document.getElementById('data-entry-body');
            const newRow = document.createElement('tr');
            
            // Create cells for each column
            currentColumns.forEach(col => {
                const prop = metricProperties[col];
                const input = document.createElement('input');
                input.type = prop.type;
                input.placeholder = prop.display;
                input.className = `entry-${col}`;
                if (prop.step) input.step = prop.step;
                
                const cell = document.createElement('td');
                cell.appendChild(input);
                newRow.appendChild(cell);
            });
            
            // Add remove button cell
            const actionCell = document.createElement('td');
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-row-btn';
            removeBtn.textContent = 'Remove';
            removeBtn.addEventListener('click', function() {
                if (tbody.children.length > 1) {
                    tbody.removeChild(newRow);
                } else {
                    showStatus('Cannot remove the last row. Use Clear All instead.', 'error');
                }
            });
            actionCell.appendChild(removeBtn);
            newRow.appendChild(actionCell);
            
            tbody.appendChild(newRow);
            showStatus('New row added successfully!', 'success');
        }

        // Function to add a new column to the data entry table
        function addNewColumn(columnName, columnKey) {
            // Add to current columns if not already present
            if (!currentColumns.includes(columnKey)) {
                currentColumns.push(columnKey);
                
                // Add to metric properties
                metricProperties[columnKey] = {
                    type: 'text',
                    display: columnName
                };
                
                // Update the data entry table header
                updateDataEntryHeader();
                
                // Add the column to existing rows
                const rows = document.querySelectorAll('#data-entry-body tr');
                rows.forEach(row => {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.placeholder = columnName;
                    input.className = `entry-${columnKey}`;
                    
                    const cell = document.createElement('td');
                    cell.appendChild(input);
                    
                    // Insert before the actions cell
                    const actionsCell = row.querySelector('td:last-child');
                    row.insertBefore(cell, actionsCell);
                });
                
                showStatus(`Column "${columnName}" added successfully!`, 'success');
            } else {
                showStatus(`Column "${columnName}" already exists.`, 'error');
            }
        }

        // Function to remove a column from the data entry table
        function removeColumn(columnKey) {
            // Don't allow removing required columns
            if (metricProperties[columnKey].required) {
                showStatus('Cannot remove required columns.', 'error');
                return;
            }
            
            // Remove from current columns
            currentColumns = currentColumns.filter(col => col !== columnKey);
            
            // Update the data entry table header
            updateDataEntryHeader();
            
            // Remove the column from existing rows
            const rows = document.querySelectorAll('#data-entry-body tr');
            const colIndex = currentColumns.indexOf(columnKey) + 2; // +2 for rank and name columns
            
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells[colIndex]) {
                    row.removeChild(cells[colIndex]);
                }
            });
            
            showStatus(`Column "${metricProperties[columnKey].display}" removed successfully!`, 'success');
        }

        // Function to update the data entry table header
        function updateDataEntryHeader() {
            const header = document.getElementById('data-entry-header');
            header.innerHTML = '';
            
            const headerRow = document.createElement('tr');
            
            // Create header cells for each column
            currentColumns.forEach(col => {
                const th = document.createElement('th');
                th.textContent = metricProperties[col].display;
                
                // Add remove button for non-required columns
                if (!metricProperties[col].required) {
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-col-btn';
                    removeBtn.textContent = '×';
                    removeBtn.setAttribute('data-col', col);
                    removeBtn.addEventListener('click', function() {
                        removeColumn(col);
                    });
                    th.appendChild(removeBtn);
                }
                
                headerRow.appendChild(th);
            });
            
            // Add actions header with add button
            const actionsTh = document.createElement('th');
            actionsTh.textContent = 'Actions';
            
            const addBtn = document.createElement('button');
            addBtn.className = 'add-col-btn';
            addBtn.textContent = '+';
            addBtn.addEventListener('click', function() {
                const colName = prompt('Enter new column name:');
                if (colName) {
                    const colKey = colName.toLowerCase().replace(/\s+/g, '');
                    addNewColumn(colName, colKey);
                }
            });
            actionsTh.appendChild(addBtn);
            
            headerRow.appendChild(actionsTh);
            header.appendChild(headerRow);
        }

        // Function to clear all data entry fields
        function clearAllEntries() {
            const inputs = document.querySelectorAll('#data-entry-body input');
            inputs.forEach(input => {
                input.value = '';
            });
            showStatus('All entry fields cleared.', 'success');
        }

        // Function to update dashboard with manual data
        function updateDashboardWithManualData() {
            const rows = document.querySelectorAll('#data-entry-body tr');
            const newData = [];
            let hasData = false;
            
            rows.forEach(row => {
                const inputs = row.querySelectorAll('input');
                const rowData = {};
                let hasRowData = false;
                
                // Get values for each column
                currentColumns.forEach((col, index) => {
                    if (index < inputs.length) {
                        const value = inputs[index].value.trim();
                        if (value) {
                            rowData[col] = value;
                            hasRowData = true;
                        }
                    }
                });
                
                // Check if at least the name is provided
                if (hasRowData && rowData.name) {
                    hasData = true;
                    
                    // Convert numeric values
                    currentColumns.forEach(col => {
                        if (metricProperties[col].type === 'number' && rowData[col]) {
                            rowData[col] = parseFloat(rowData[col]);
                        }
                    });
                    
                    newData.push(rowData);
                }
            });
            
            if (!hasData) {
                showStatus('Please enter at least one warehouse name.', 'error');
                return;
            }
            
            // Update the warehouseData
            warehouseData = newData;
            
            // Update the dashboard
            populateDashboard();
            updatePodium();
            updateAverages();
            
            // Start the countdown animation
            animateRankingWithCountdown();
        }

        // Function to reset to original data
        function resetToOriginalData() {
            // Reload the original data
            warehouseData = [
                {
                    name: "Mandawali Mnow SF",
                    serviceability: "100.00%",
                    units: 1218,
                    deliveredUnits: 1048,
                    orders: 778,
                    deliveredOrders: 663,
                    sla: 48.42,
                    o2d: 21.23,
                    breadx: "0.26%",
                    deepPain: "0.00%",
                    cancellation: "9.00%",
                    rto: "0.51%",
                    rank: 1
                },
                {
                    name: "PushpVihar Mnow SF",
                    serviceability: "100.00%",
                    units: 970,
                    deliveredUnits: 793,
                    orders: 615,
                    deliveredOrders: 493,
                    sla: 57.55,
                    o2d: 27.55,
                    breadx: "0.33%",
                    deepPain: "0.00%",
                    cancellation: "12.03%",
                    rto: "0.98%",
                    rank: 2
                },
                {
                    name: "Janakpuri Mnow SF",
                    serviceability: "100.00%",
                    units: 949,
                    deliveredUnits: 840,
                    orders: 611,
                    deliveredOrders: 547,
                    sla: 47.68,
                    o2d: 16.85,
                    breadx: "0.49%",
                    deepPain: "0.33%",
                    cancellation: "3.60%",
                    rto: "1.64%",
                    rank: 3
                },
                {
                    name: "Sultanpuri Mnow SF",
                    serviceability: "100.00%",
                    units: 831,
                    deliveredUnits: 717,
                    orders: 501,
                    deliveredOrders: 416,
                    sla: 51.92,
                    o2d: 24.79,
                    breadx: "1.20%",
                    deepPain: "0.00%",
                    cancellation: "10.18%",
                    rto: "1.40%",
                    rank: 4
                },
                {
                    name: "KirtNagar Mnow SF",
                    serviceability: "100.00%",
                    units: 905,
                    deliveredUnits: 771,
                    orders: 564,
                    deliveredOrders: 487,
                    sla: 49,
                    o2d: 19.03,
                    breadx: "0.71%",
                    deepPain: "0.00%",
                    cancellation: "8.87%",
                    rto: "1.60%",
                    rank: 5
                }
            ];
            
            // Reset to default columns
            currentColumns = Object.keys(metricProperties);
            updateDataEntryHeader();
            
            // Update the dashboard
            populateDashboard();
            updatePodium();
            updateAverages();
            
            // Start the countdown animation
            animateRankingWithCountdown();
        }

        // Function to show status messages
        function showStatus(message, type) {
            const statusEl = document.getElementById('status-message');
            statusEl.textContent = message;
            statusEl.className = `status-message status-${type}`;
            
            // Auto-hide after 3 seconds
            setTimeout(() => {
                statusEl.style.display = 'none';
            }, 3000);
        }

        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', () => {
            // Set up the data entry table header
            updateDataEntryHeader();
            
            // Populate the dashboard with initial data
            populateDashboard();
            updatePodium();
            updateAverages();
            
            // Add event listeners
            document.getElementById('animate-rank').addEventListener('click', animateRankingWithCountdown);
            document.getElementById('reset-data').addEventListener('click', resetToOriginalData);
            document.getElementById('add-new-row').addEventListener('click', addNewRow);
            document.getElementById('update-dashboard').addEventListener('click', updateDashboardWithManualData);
            document.getElementById('clear-all').addEventListener('click', clearAllEntries);
            
            // Add custom column functionality
            document.getElementById('add-custom-col').addEventListener('click', function() {
                const colName = document.getElementById('new-column-name').value.trim();
                if (colName) {
                    const colKey = colName.toLowerCase().replace(/\s+/g, '');
                    addNewColumn(colName, colKey);
                    document.getElementById('new-column-name').value = '';
                } else {
                    showStatus('Please enter a column name.', 'error');
                }
            });
            
            // Add event listener to the initial Remove button
            document.querySelector('.remove-row-btn').addEventListener('click', function() {
                const tbody = document.getElementById('data-entry-body');
                if (tbody.children.length > 1) {
                    tbody.removeChild(tbody.children[0]);
                } else {
                    showStatus('Cannot remove the last row. Use Clear All instead.', 'error');
                }
            });
        });
    </script>
</body>
</html>
